Shell assembly with contact
===========================

**Features**

  + Shell assembly
  + Edge to face MPC contact
  + Penalty contact between structure and indenter

**Downloads**

  + `Files on Github <https://github.com/mkraska/CalculiX-Examples/tree/master/Contact/Shell1>`_
  + :download:`pre.fbd`
  + :download:`post.fbd`
  + :download:`tie.inp`

.. toctree::
  :maxdepth: 2

This example demonstrates the interaction between a minimal honeycomb sandwich structure and an indenter.

.. list-table::

  * - Preprocessing :download:`pre.fbd` ::

        > cgx -b pre.fbd

      The plot shows the shell meshes of the individual bodies, Note that you see the element edges on the negative side of the shell elements because
      ``view back`` was used.

    - .. image:: Refs/model.png
        :width: 100%

  * - Solving :download:`tie.inp` ::

        > ccx tie
        > ,,/,,/Scripts/monitor.py tie

      The solution converges with the default settings in a single step.
      The convergence plot shows, that the initial penetration creates
      more than 2000 contact elements, This number then stabilizes at approximately 100 elements.

    - .. image:: tie.png
        :width: 100%
  * - Post-processing :download:`post.fbd` ::

        > cgx -b post.fbd

    - \
  * - Shaded plot of the deformed system

      .. image:: Refs/def.png
        :width: 100%

    - Plot of the worst principal stress

      .. image:: Refs/worstPS.png
        :width: 100%




pre.fbd
-------

.. list-table::

  * - .. literalinclude:: pre.fbd
        :start-after: # parameters
        :end-before: # core
    - :rc: width of the core sheets
      :tc: thickness of the core sheets
      :hc: height of the core
      :ls: length of the skin sheets
      :ri: radius of the indenter
      :xi: excentricity of the indenter
      :ts: thickness of the skin sheets
  * - .. literalinclude:: pre.fbd
        :start-after: # core
        :end-before: # skin
    - The core consists of three vertical plates, which are connected in the
      center.

      Point ``p0`` at the origin is swept in x direction, the resulting line
      is copied and rotated by :math:`\pm` 120Â°.

      These three lines form the set ``c_bottom``, which we later use for contact definition.

      The lines are swept in z direction, the copy of the generating set is named ``c_top`` and also later used for contact.

      The resulting structure is stored in set ``core`` for later material and thickness assignment.
  * - .. literalinclude:: pre.fbd
        :start-after: # skin
        :end-before: # edges
    - The bottom skin sheet (set ``bottom``) is created from corner point
      ``ps1``  by sweep in negative x and y directions.

      The top skin (set ``top``) is created as a translated copy of the bottom skin.

      Both skins have their positive sides down, therefore we flip the bottom skin to make both skins face the core.
  * - .. literalinclude:: pre.fbd
        :start-after: # edges
        :end-before: # indenter
    - Generate sets for the edges of the skins.
      These are used later for displacement constraints. The ``comp`` commands are required to include the corner points in the sets.
  * - .. literalinclude:: pre.fbd
        :start-after: # indenter
        :end-before: # positioning
    - Generate the hemisherical indenter.

      First we define a quarter of the hemisphere by explicitly specifying
      points, lines and the surface. Note, that the resulting surface is only roughly spherical. In the given case this does not matter.

      The hemisphere is generated by two successive copy commands. The duplicate nodes are removed by the merg command.
  * - .. literalinclude:: pre.fbd
        :start-after: # positioning
        :end-before: # meshing
    - Place the indenter into starting position.
      We first have to adjust the orientation, then we move the indenter to just touch the top face of the top skin (account for the invisible shell thickness). Last we move the indenter to a slightly excentric position.
  * - .. literalinclude:: pre.fbd
          :start-after: # meshing
          :end-before: # surfaces
    - Increase the default division of the lines

      Mesh with ``qu8``, these are written as ``S8R`` elements.

      Write the mesh and all set definitions. We don't need all but don't want to send them individually.
  * - .. literalinclude:: pre.fbd
          :start-after: # surfaces
          :end-before: # image
    - Write the surface definitions, required for contact definition.

      A separate set for the negative side of the top skin is required, because the file name does not account for the - sign and both sides would be written to the same file.
  * - .. literalinclude:: pre.fbd
          :start-after: # image
    - Create a representative view of the geometry. The element edges are visible on the negative side of the surfaces.

      .. image:: Refs/model.png
        :width: 30%


tie.inp
-------

.. list-table::

  * - .. literalinclude:: tie.inp
        :start-after: ** includes
        :end-before: ** constraints
    - Include the files generated by CGX
  * - .. literalinclude:: tie.inp
        :start-after: ** constraints
        :end-before: ** material
    - Constrain the displacement of the edge of the bottom skin and of the
      indenter
  * - .. literalinclude:: tie.inp
        :start-after: ** material
        :end-before: ** sections
    - Define the material Aluminium with Young's modulus and Poisson's ratio.
      The density is provided for eventual modal analysis.
  * - .. literalinclude:: tie.inp
        :start-after: ** sections
        :end-before: ** ties
    - Assign material and thickness to the shell element sets.
      An offset of 0.5 times the thickness is applied, this shifts the reference surface to the positive side.
  * - .. literalinclude:: tie.inp
        :start-after: ** ties
        :end-before: ** penalty
    - Define MPC contact between the core and the skin sheets.
  * - .. literalinclude:: tie.inp
        :start-after: ** penalty
        :end-before: ** step
    - Define penalty contact between the top skin and the indenter.
  * - .. literalinclude:: tie.inp
        :start-after: ** step
        :end-before: ** load
    - Start a non-inear static step with default time stepping settings
  * - .. literalinclude:: tie.inp
        :start-after: ** load
        :end-before: ** output
    - Move the indenter 2 mm down.
  * - .. literalinclude:: tie.inp
        :start-after: ** output
        :end-before: ** endstep
    - Request output of the displacements (U) and the stresses (S) to the frd-file.
  * - .. literalinclude:: tie.inp
        :start-after: ** endstep
    - End of the step


post.fbd
--------

.. list-table::

  * - .. literalinclude:: post.fbd
        :start-after: # read
        :end-before: # view
    - Read the results (frd) and the input file (for the set definitions)
  * - .. literalinclude:: post.fbd
        :start-after: # view
        :end-before: # def
    - Switch on the deformed geometry and element edges.

      Adjust the view orientation
  * - .. literalinclude:: post.fbd
        :start-after: # def
        :end-before: # color
    - Shaded displacement plot

      .. image:: Refs/def.png
        :width: 30%
  * - .. literalinclude:: post.fbd
        :start-after: # color
    - Plot of the worst principal stress

      .. image:: Refs/worstPS.png
        :width: 30%
